{% extends "base.html" %}

{% block title %}Select Models - Dawlance Cost Tracker{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header Section -->
        <div class="text-center mb-12">
            <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl shadow-lg mb-6">
                <i class="fas fa-cogs text-white text-3xl"></i>
            </div>
            <h1 class="text-4xl font-bold text-gray-900 mb-4">
                Select Product Models
            </h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                Choose the specific models you want to track for each product category
            </p>
        </div>

        <!-- Main Content Card -->
        <div class="bg-white rounded-3xl shadow-2xl border border-gray-100 overflow-hidden">
            <div class="p-8 lg:p-12">
                <form method="POST">
                    {% for product, models in product_models.items() %}
                        <div class="mb-12 bg-gradient-to-r from-gray-50 to-blue-50 rounded-2xl p-8 border-2 border-gray-200 hover:shadow-lg transition-all duration-300">
                            <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-8 gap-6">
                                <div class="flex items-center">
                                    <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center mr-6 shadow-lg">
                                        <i class="fas fa-box text-white text-2xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-2xl font-bold text-gray-900 mb-2">
                                            {{ product }}
                                        </h3>
                                        <p class="text-sm text-gray-600 font-medium bg-white px-3 py-1 rounded-full inline-block">
                                            {{ models|length }} models available
                                        </p>
                                    </div>
                                </div>
                                <button type="button"
                                        onclick="toggleCheckboxes('{{ product|replace(' ', '_') }}')"
                                        class="px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-xl text-sm font-semibold transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-3">
                                    <i class="fas fa-check-double"></i>
                                    Toggle All
                                </button>
                            </div>

                            <div id="section-{{ product|replace(' ', '_') }}"
                                 class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                                {% for model in models %}
                                    <label class="flex items-start space-x-4 p-6 rounded-xl bg-white hover:bg-blue-50 transition-all duration-200 cursor-pointer border-2 border-gray-200 hover:border-blue-300 shadow-sm hover:shadow-md group">
                                        <input type="checkbox"
                                               name="selected_models"
                                               value="{{ model.model_id }}"
                                               class="mt-1 h-5 w-5 text-indigo-600 rounded border-2 border-gray-300 focus:ring-indigo-500 focus:ring-2 model-checkbox-{{ product|replace(' ', '_') }} transition-all duration-200">
                                        <div class="flex-1 min-w-0">
                                            <div class="text-gray-900 font-bold text-base mb-2 group-hover:text-indigo-600 transition-colors">
                                                {{ model.name }}
                                            </div>
                                            <div class="text-sm text-gray-600 leading-relaxed">
                                                {{ model.description or 'No description available' }}
                                            </div>
                                        </div>
                                    </label>
                                {% endfor %}
                            </div>
                        </div>
                    {% endfor %}

                    <!-- Action Buttons -->
                    <div class="flex flex-col sm:flex-row justify-between items-center pt-8 border-t-2 border-gray-200 gap-6">
                        <a href="{{ url_for('product_select') }}" 
                           class="inline-flex items-center justify-center px-8 py-4 bg-white border-2 border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 shadow-sm hover:shadow-md w-full sm:w-auto">
                            <i class="fas fa-arrow-left mr-3"></i>
                            Back to Products
                        </a>
                        <button type="submit"
                                class="inline-flex items-center justify-center px-12 py-4 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold rounded-xl shadow-xl transition-all duration-200 transform hover:scale-105 hover:shadow-2xl text-lg w-full sm:w-auto">
                            Continue to Tracking
                            <i class="fas fa-arrow-right ml-3"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Help Section -->
        <div class="mt-10 bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-2xl p-8">
            <div class="text-center">
                <h3 class="text-xl font-bold text-gray-900 mb-4">
                    <i class="fas fa-info-circle text-purple-600 mr-3"></i>
                    Model Selection Guide
                </h3>
                <p class="text-gray-700 max-w-4xl mx-auto leading-relaxed">
                    Select the specific product models that will be affected by your project. You can choose multiple models within each product category to ensure comprehensive tracking and analysis.
                </p>
            </div>
        </div>
    </div>
</div>

<style>
    /* Custom checkbox styling */
    input[type="checkbox"]:checked {
        background-color: #4f46e5;
        border-color: #4f46e5;
    }
    
    /* Enhanced focus states */
    button:focus, input:focus {
        outline: none;
        ring: 4px;
        ring-color: rgba(79, 70, 229, 0.3);
    }

    /* Smooth transitions for all interactive elements */
    * {
        transition: all 0.2s ease;
    }

    /* Smooth scroll behavior */
    html {
        scroll-behavior: smooth;
    }

    /* Enhanced hover effects */
    label:hover {
        transform: translateY(-2px);
    }
</style>

<script>
    function toggleCheckboxes(sectionKey) {
        const checkboxes = document.querySelectorAll('.model-checkbox-' + sectionKey);
        const allChecked = Array.from(checkboxes).every(cb => cb.checked);
        
        checkboxes.forEach(cb => {
            cb.checked = !allChecked;
            const label = cb.closest('label');
            if (!allChecked) {
                label.classList.add('bg-indigo-50', 'border-indigo-400', 'ring-2', 'ring-indigo-200');
                label.classList.remove('bg-white', 'border-gray-200');
            } else {
                label.classList.remove('bg-indigo-50', 'border-indigo-400', 'ring-2', 'ring-indigo-200');
                label.classList.add('bg-white', 'border-gray-200');
            }
        });
    }

    // Add visual feedback for individual checkbox changes
    document.addEventListener('DOMContentLoaded', function() {
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const label = this.closest('label');
                if (this.checked) {
                    label.classList.add('bg-indigo-50', 'border-indigo-400', 'ring-2', 'ring-indigo-200');
                    label.classList.remove('bg-white', 'border-gray-200');
                } else {
                    label.classList.remove('bg-indigo-50', 'border-indigo-400', 'ring-2', 'ring-indigo-200');
                    label.classList.add('bg-white', 'border-gray-200');
                }
            });
        });

        // Form validation
        const form = document.querySelector('form');
        form.addEventListener('submit', function(e) {
            const selectedModels = document.querySelectorAll('input[name="selected_models"]:checked');
            if (selectedModels.length === 0) {
                e.preventDefault();
                alert('Please select at least one model before continuing.');
                return false;
            }
        });
    });
</script>
{% endblock %}